---
- name: Update package cache
  package:
    update_cache: yes
  changed_when: false

- name: Install required system packages
  package:
    name: "{{ system_packages }}"
    state: present

- name: Verify essential tools are available
  command: "{{ item }} --version"
  loop:
    - git
    - curl
    - python3
    - gcc
    - make
  register: tool_versions
  changed_when: false
  ignore_errors: yes

- name: Display installed tool versions
  debug:
    msg: |
      Essential development tools verified:
      {% for result in tool_versions.results %}
      {% if result.rc == 0 %}
      ✓ {{ result.item }}: {{ result.stdout.split('\n')[0] }}
      {% else %}
      ✗ {{ result.item }}: Not available
      {% endif %}
      {% endfor %}
